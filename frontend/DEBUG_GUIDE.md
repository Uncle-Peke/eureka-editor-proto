# 🔍 サーバサイドブレークポイントテストガイド

このプロジェクトには、サーバサイドの処理でブレークポイントが正しく動作するかを確認するためのテスト機能が含まれています。

## 📁 作成されたファイル

1. **`src/app/api/debug/route.ts`** - 基本的なブレークポイントテスト用 API
2. **`src/app/api/debug/complex/route.ts`** - 複雑な処理のブレークポイントテスト用 API
3. **`src/app/debug-test/page.tsx`** - テスト用のフロントエンドページ

## 🚀 使用方法

### 1. 開発サーバーの起動

```bash
npm run dev
```

### 2. テストページへのアクセス

ブラウザで `http://localhost:3000/debug-test` にアクセスしてください。

### 3. ブレークポイントの設定

#### 基本的な API (`src/app/api/debug/route.ts`)

以下の行にブレークポイントを設定してください：

- **行 5**: リクエスト開始
- **行 11**: パラメータ処理
- **行 18**: ループ内処理
- **行 25**: 結果処理
- **行 30**: エラーケース
- **行 35**: 遅い処理
- **行 41**: 通常ケース
- **行 46**: レスポンス作成
- **行 52**: POST リクエスト開始
- **行 58**: リクエストボディ処理
- **行 68**: 処理完了
- **行 76**: エラーハンドリング

#### 複雑な API (`src/app/api/debug/complex/route.ts`)

以下の行にブレークポイントを設定してください：

- **行 15**: 関数開始
- **行 22**: データ検証後
- **行 29**: アイテム処理ループ
- **行 40**: アイテム処理完了
- **行 50**: メタデータ更新
- **行 58**: リクエスト開始
- **行 64**: リクエストボディ取得
- **行 71**: 型チェック後
- **行 74**: 処理完了
- **行 85**: レスポンス作成
- **行 92**: エラーハンドリング
- **行 98**: GET リクエスト開始
- **行 103**: パラメータ処理
- **行 108**: データ生成
- **行 125**: データ生成完了
- **行 132**: エラーシミュレーション
- **行 137**: デフォルトケース

## 🧪 テストケース

### 基本的な API テスト

1. **通常の GET リクエスト**

   - 基本的な処理フローをテスト
   - ブレークポイントが順番に動作することを確認

2. **遅い処理テスト**

   - 2 秒の遅延処理をシミュレート
   - 非同期処理中のブレークポイント動作を確認

3. **エラーケーステスト**

   - エラーハンドリングのブレークポイント動作を確認

4. **POST リクエストテスト**
   - リクエストボディの処理をテスト
   - 複雑なデータ構造の処理を確認

### 複雑な API テスト

1. **データ生成テスト**

   - `GET /api/debug/complex?action=generate`
   - 複雑なデータ構造の生成をテスト

2. **複雑なデータ処理テスト**

   - `POST /api/debug/complex`
   - 複雑なデータ構造の処理をテスト

3. **エラーシミュレーションテスト**
   - `GET /api/debug/complex?action=simulate-error`
   - エラーハンドリングをテスト

## 🔧 デバッグのコツ

1. **コンソールログの確認**

   - 各ブレークポイントの前後で `console.log` が出力されます
   - ログメッセージに 🔍 マークが付いているので見つけやすいです

2. **ステップ実行**

   - ブレークポイントで停止した後、ステップ実行で処理の流れを確認
   - 変数の値を確認して期待通りの動作をしているかチェック

3. **条件付きブレークポイント**
   - 特定の条件でのみ停止したい場合は、条件付きブレークポイントを設定
   - 例：`testParam === 'slow'` の条件でブレークポイントを設定

## 🐛 トラブルシューティング

### ブレークポイントが動作しない場合

1. **開発サーバーの再起動**

   ```bash
   # 開発サーバーを停止して再起動
   npm run dev
   ```

2. **ブラウザのキャッシュクリア**

   - ブラウザの開発者ツールでキャッシュをクリア
   - ハードリフレッシュ（Ctrl+Shift+R）を実行

3. **TypeScript の型チェック**
   ```bash
   # 型エラーがないか確認
   npx tsc --noEmit
   ```

### よくある問題

- **ブレークポイントが灰色になる**: ファイルが保存されていない可能性があります
- **ブレークポイントが動作しない**: 開発サーバーが再起動されている可能性があります
- **エラーが発生する**: コンソールログを確認してエラーの詳細を確認してください

## 📝 追加のテストケース

必要に応じて、以下のようなテストケースを追加できます：

1. **データベース接続テスト**
2. **外部 API 呼び出しテスト**
3. **ファイル操作テスト**
4. **認証・認可テスト**

これらのテストケースは、実際のプロジェクトの要件に応じて実装してください。
